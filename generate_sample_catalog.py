"""
Generate sample PIM catalog Excel file.
Usage: python generate_sample_catalog.py
Output: pim_catalog_sample.xlsx
"""
import pandas as pd


def generate_sample():
    """Create sample product catalog for PIM upload."""
    
    data = [
        # Велосипеды / Bikes
        {
            "SKU": "VEL-001",
            "Название": "Велосипед горный Trek Marlin 5 27.5",
            "Длина": 175,
            "Ширина": 60,
            "Высота": 105,
            "Вес": 13.5,
            "Себестоимость": 25000,
            "EAN": "4710476893205",
            "Бренд": "Trek",
            "Категория": "Велосипеды",
            "Описание": "Горный велосипед начального уровня с 21 скоростью",
            "Фото": "https://example.com/trek-marlin5.jpg",
        },
        {
            "SKU": "VEL-002",
            "Название": "Велосипед городской Giant Escape 3",
            "Длина": 170,
            "Ширина": 55,
            "Высота": 100,
            "Вес": 11.2,
            "Себестоимость": 18000,
            "EAN": "4713250803116",
            "Бренд": "Giant",
            "Категория": "Велосипеды",
            "Описание": "Легкий городской велосипед с алюминиевой рамой",
            "Фото": "",
        },
        # Самокаты / Scooters
        {
            "SKU": "SAM-001",
            "Название": "Самокат детский Globber Primo 3-х колесный",
            "Длина": 75,
            "Ширина": 40,
            "Высота": 80,
            "Вес": 2.8,
            "Себестоимость": 3500,
            "EAN": "4897070183498",
            "Бренд": "Globber",
            "Категория": "Самокаты",
            "Описание": "Трехколесный самокат для детей 2-6 лет",
            "Фото": "",
        },
        {
            "SKU": "SAM-002",
            "Название": "Самокат Razor A5 Lux складной",
            "Длина": 85,
            "Ширина": 38,
            "Высота": 95,
            "Вес": 3.2,
            "Себестоимость": 5200,
            "EAN": "845423018498",
            "Бренд": "Razor",
            "Категория": "Самокаты",
            "Описание": "Складной самокат для подростков и взрослых",
            "Фото": "",
        },
        # Шлемы / Helmets
        {
            "SKU": "SHL-001",
            "Название": "Шлем велосипедный Alpina Ownster Kids",
            "Длина": 32,
            "Ширина": 26,
            "Высота": 22,
            "Вес": 0.35,
            "Себестоимость": 1800,
            "EAN": "4003692289513",
            "Бренд": "Alpina",
            "Категория": "Шлемы",
            "Описание": "Детский велосипедный шлем с регулировкой",
            "Фото": "",
        },
        # Электротранспорт / E-transport
        {
            "SKU": "ELEC-001",
            "Название": "Электросамокат Ninebot ES2",
            "Длина": 113,
            "Ширина": 43,
            "Высота": 114,
            "Вес": 12.5,
            "Себестоимость": 28000,
            "EAN": "8719324545136",
            "Бренд": "Ninebot",
            "Категория": "Электротранспорт",
            "Описание": "Электрический самокат мощностью 300W",
            "Фото": "",
        },
        # Товары без габаритов (для демонстрации обогащения)
        {
            "SKU": "VEL-003",
            "Название": "Велосипед BMX Mongoose Legion L20",
            "Длина": None,
            "Ширина": None,
            "Высота": None,
            "Вес": None,
            "Себестоимость": 12000,
            "EAN": "",
            "Бренд": "Mongoose",
            "Категория": "Велосипеды",
            "Описание": "",
            "Фото": "",
        },
        {
            "SKU": "ROL-001",
            "Название": "Ролики Rollerblade Microblade G",
            "Длина": None,
            "Ширина": None,
            "Высота": None,
            "Вес": None,
            "Себестоимость": 4800,
            "EAN": "7630017001085",
            "Бренд": "Rollerblade",
            "Категория": "Ролики",
            "Описание": "Детские ролики с регулируемым размером 28-32",
            "Фото": "",
        },
        # Для М.Видео
        {
            "SKU": "TV-001",
            "Название": "Телевизор Samsung 55 QLED 4K",
            "Длина": None,
            "Ширина": None,
            "Высота": None,
            "Вес": None,
            "Себестоимость": 55000,
            "EAN": "8806092044074",
            "Бренд": "Samsung",
            "Категория": "Телевизоры",
            "Описание": "55-дюймовый QLED телевизор с 4K разрешением",
            "Фото": "",
        },
        {
            "SKU": "PHN-001",
            "Название": "Смартфон Apple iPhone 15 128GB",
            "Длина": None,
            "Ширина": None,
            "Высота": None,
            "Вес": None,
            "Себестоимость": 65000,
            "EAN": "194253714644",
            "Бренд": "Apple",
            "Категория": "Смартфоны",
            "Описание": "Смартфон Apple iPhone 15 с 128 ГБ памяти",
            "Фото": "",
        },
        # Для Леман Про
        {
            "SKU": "TOOL-001",
            "Название": "Перфоратор Bosch GBH 2-28 DFV",
            "Длина": None,
            "Ширина": None,
            "Высота": None,
            "Вес": None,
            "Себестоимость": 12500,
            "EAN": "4060649198504",
            "Бренд": "Bosch",
            "Категория": "Профессиональные инструменты",
            "Описание": "Перфоратор с функцией удара и сверления",
            "Фото": "",
        },
        {
            "SKU": "TOOL-002",
            "Название": "Шуруповерт Dewalt DCD791D2",
            "Длина": None,
            "Ширина": None,
            "Высота": None,
            "Вес": None,
            "Себестоимость": 18000,
            "EAN": "5706452506189",
            "Бренд": "Dewalt",
            "Категория": "Профессиональные инструменты",
            "Описание": "Бесщеточный шуруповерт 18V в кейсе",
            "Фото": "",
        },
    ]
    
    df = pd.DataFrame(data)
    
    # Save to Excel
    output_file = "pim_catalog_sample.xlsx"
    with pd.ExcelWriter(output_file, engine="openpyxl") as writer:
        df.to_excel(writer, index=False, sheet_name="Каталог")
        
        # Format the sheet
        ws = writer.sheets["Каталог"]
        
        # Set column widths
        col_widths = {
            "A": 12,   # SKU
            "B": 45,   # Название
            "C": 10,   # Длина
            "D": 10,   # Ширина
            "E": 10,   # Высота
            "F": 10,   # Вес
            "G": 15,   # Себестоимость
            "H": 18,   # EAN
            "I": 15,   # Бренд
            "J": 25,   # Категория
            "K": 50,   # Описание
            "L": 40,   # Фото
        }
        for col, width in col_widths.items():
            ws.column_dimensions[col].width = width
    
    print(f"Sample catalog saved to {output_file}")
    print(f"Total products: {len(df)}")
    print(f"With dimensions: {df['Длина'].notna().sum()}")
    print(f"Without dimensions (for enrichment demo): {df['Длина'].isna().sum()}")
    return df


if __name__ == "__main__":
    generate_sample()
